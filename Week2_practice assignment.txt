1. Pull total number of orders that were completed on 18th March 2023

SELECT date
COUNT (distinct order_id) as orders
FROM Sales
WHERE date = “03-18-2023”
GROUP BY date

2. Pull total number of orders that were completed on 18th March 2023 with the first name ‘John’ and last name ‘Doe’

SELECT s.date
COUNT (distinct s.order_id) as orders
FROM Sales as s
JOIN Customers as c
On c.Customer_id = s.Customer_id 
WHERE s.date = “03-18-2023”
GROUP BY s.date
HAVING c.First_name = "John" AND c.Last_name = "Doe"


3. Pull total number of customers that purchased in January 2023 and the average amount spend per customer

SELECT 

COUNT(distinct Customer_id) as total_number_customer 
SUM(revenue)/total_number_customer as spend_per_customer

FROM SALES

WHERE CAST( date as string)
like ("01-%-2023")

4. Pull the departments that generated less than $600 in 2022

SELECT i.department
SUM(s.revenue) as rev
FROM Items as i
JOIN Sales as s on i.item_id = s.item_id
GROUP BY i.department
HAVING rev < 600 and (CAST(s.date as string) like ("%-%-2022"))

5. What is the most and least revenue we have generated by an order

SELECT order_id

MAX(revenue) as most_revenue
MIN(revenue) as least_revenue

FROM Sales
GROUP BY order_id

6. What were the orders that were purchased in our most lucrative order

SELECT order_id

SUM(revenue) as rev

FROM Sales
GROUP BY order_id

HAVING rev =(
             SELECT order_id 
             Max(SUM(revenue)) as max_rev
             FROM Sales
             GROUP BY order_id)

